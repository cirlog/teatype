/**
 * @license
 * Copyright (C) 2024-2026 Burak GÃ¼naydin
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 */

@import 'variables';

.iphone-preview {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    padding: 40px;

    &__frame {
        position: relative;
        width: $iphone-preview-width;
        height: $iphone-preview-height;
        background: #1c1c1e;
        border-radius: $iphone-border-radius;
        padding: $iphone-bezel;
        box-shadow: 0 50px 100px rgba(0, 0, 0, 0.5), inset 0 0 0 1px rgba(255, 255, 255, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.15);

        // Outer edge highlight
        &::before {
            content: '';
            position: absolute;
            inset: -1px;
            border-radius: $iphone-border-radius + 1px;
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
            z-index: -1;
        }
    }

    &__dynamic-island {
        position: absolute;
        top: 24px;
        left: 50%;
        transform: translateX(-50%);
        width: 90px;
        height: 28px;
        background: #000;
        border-radius: 20px;
        z-index: 10;
    }

    &__screen {
        position: relative;
        width: 100%;
        height: 100%;
        border-radius: $iphone-border-radius - $iphone-bezel;
        overflow: hidden;
        background: #000;
    }

    &__background {
        position: absolute;
        inset: 0;
        background-size: cover;
        background-position: center;
        filter: blur(1.5rem) brightness(0.4); // Match canvas: blur(50px) brightness(0.4)
        transform: scale(1.15); // Prevent blur edge artifacts
    }

    &__polaroid {
        // Canvas calculations at 1320x2868:
        // polaroidWidth = 1320 * 0.85 = 1122px
        // polaroidPadding = 1320 * 0.04 = 52.8px (sides + top)
        // polaroidBottomPadding = 1320 * 0.12 = 158.4px
        // photoWidth = 1122 - 52.8*2 = 1016.4px
        // photoHeight = 1016.4 * 1.25 = 1270.5px
        // polaroidHeight = 52.8 + 1270.5 + 158.4 = 1481.7px
        // Polaroid center from top: (607.1 + 1481.7/2) / 2868 = 46.95%

        position: absolute;
        top: 47%;
        left: 50%;
        transform: translate(-50%, -50%);
        width: 85%;
        background: $polaroid-white;
        border-radius: 4px;
        box-shadow: 0 10px 30px $polaroid-shadow, 0 5px 15px rgba(0, 0, 0, 0.2);
        overflow: hidden;

        // Only top and side padding - bottom is handled by label container
        // 4% of screen = 4/85 = 4.7% of polaroid width
        padding: 4.7%;
        padding-bottom: 0;
    }

    &__polaroid-texture {
        position: absolute;
        inset: 0;
        background-size: cover;
        background-position: center;
        filter: blur(30px) brightness(1.4) saturate(0.3);
        opacity: 0.15;
        transform: scale(1.2);
        pointer-events: none;
    }

    &__polaroid-photo-container {
        position: relative;
        width: 100%;
        aspect-ratio: 4 / 5;
        flex-shrink: 0;
        overflow: hidden;
    }

    &__polaroid-photo {
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;

        &--filtered {
            filter: sepia(0.1) saturate(1.1) brightness(1.02) contrast(0.95);
        }
    }

    &__polaroid-gloss {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(120deg, rgba(255, 255, 255, 0.6), transparent 60%, rgba(0, 0, 0, 0.5) 99%);
        box-shadow: inset 0 0 10px 1px rgba(0, 0, 0, 0.2);
        z-index: 10;
        pointer-events: none;
    }

    &__polaroid-grain {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
        opacity: 0.08;
        z-index: 11;
        pointer-events: none;
        mix-blend-mode: overlay;
    }

    &__polaroid-label {
        // Bottom padding area: 12% of screen = 14.1% of polaroid width
        // This includes the gap from photo + the label content
        // Canvas draws label at: photoY + photoHeight + polaroidPadding (4% of screen)
        height: 14.1%;
        box-sizing: border-box;
        padding-top: 4.7%; // Same as side padding for gap above label
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        color: $polaroid-text-primary;
        line-height: 1.2;
    }

    &__polaroid-meta {
        font-family: 'Inter', sans-serif;
        font-size: 14px;
        color: $polaroid-text-secondary;
        line-height: 1.3;
    }

    &__status-bar {
        position: absolute;
        top: 16px;
        left: 0;
        right: 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 24px;
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
        font-size: 14px;
        font-weight: 600;
        color: $text-primary;
        z-index: 15;
    }

    &__carrier {
        font-weight: 600;
    }

    &__status-icons {
        display: flex;
        align-items: center;
        gap: 4px;
        font-size: 12px;
    }

    &__battery {
        font-size: 12px;
    }

    &__date {
        position: absolute;
        top: 80px;
        left: 50%;
        transform: translateX(-50%);
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
        font-size: 18px;
        font-weight: 500;
        color: $text-primary;
        z-index: 15;
    }

    &__clock {
        position: absolute;
        top: 105px;
        left: 50%;
        transform: translateX(-50%);
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
        font-size: 80px;
        font-weight: 700;
        color: $text-primary;
        letter-spacing: -2px;
        z-index: 15;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }

    &__bottom-bar {
        position: absolute;
        bottom: 40px;
        left: 0;
        right: 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 40px;
        z-index: 15;
    }

    &__bottom-button {
        width: 50px;
        height: 50px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        backdrop-filter: blur(10px);
    }

    &__focus-mode {
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
        font-size: 14px;
        font-weight: 500;
        color: $text-primary;
        display: flex;
        align-items: center;
        gap: 6px;
    }

    &__home-indicator {
        position: absolute;
        bottom: 12px;
        left: 50%;
        transform: translateX(-50%);
        width: 135px;
        height: 5px;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 3px;
        z-index: 15;
    }

    &__empty {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100%;
        color: $text-tertiary;
        font-size: 12px;
        text-align: center;
        padding: 20px;
    }
}
