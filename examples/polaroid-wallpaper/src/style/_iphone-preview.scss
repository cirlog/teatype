/**
 * @license
 * Copyright (C) 2024-2026 Burak GÃ¼naydin
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 */

@import 'variables';

.iphone-preview {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    padding: 40px;

    &__frame {
        position: relative;
        width: $iphone-preview-width;
        height: $iphone-preview-height;
        background: #1c1c1e;
        border-radius: $iphone-border-radius;
        padding: $iphone-bezel;
        box-shadow: 0 50px 100px rgba(0, 0, 0, 0.5), inset 0 0 0 1px rgba(255, 255, 255, 0.1),
            inset 0 1px 0 rgba(255, 255, 255, 0.15);

        // Outer edge highlight
        &::before {
            content: '';
            position: absolute;
            inset: -1px;
            border-radius: $iphone-border-radius + 1px;
            background: linear-gradient(to bottom, rgba(255, 255, 255, 0.15), rgba(255, 255, 255, 0.05));
            z-index: -1;
        }
    }

    &__dynamic-island {
        position: absolute;
        top: 24px;
        left: 50%;
        transform: translateX(-50%);
        width: 90px;
        height: 28px;
        background: #000;
        border-radius: 20px;
        z-index: 10;
    }

    &__screen {
        position: relative;
        width: 100%;
        height: 100%;
        border-radius: $iphone-border-radius - $iphone-bezel;
        overflow: hidden;
        background: #000;
    }

    &__background {
        position: absolute;
        inset: 0;
        background-size: cover;
        background-position: center;
        // Use CSS variables from shared config
        filter: blur(var(--bg-blur)) brightness(var(--bg-brightness));
        transform: scale(var(--bg-scale, 1.15)); // Prevent blur edge artifacts
    }

    &__polaroid {
        position: absolute;
        top: var(--polaroid-top, 47%);
        left: 50%;
        transform: translate(-50%, -50%);
        width: var(--polaroid-width, 85%);
        // Background is now a blurred image, set via the background element
        background: transparent;
        border-radius: var(--polaroid-border-radius, 8px);
        box-shadow: 0 var(--shadow-offset-y, 20px) var(--shadow-blur, 60px) var(--shadow-color, rgba(0, 0, 0, 0.5)),
            0 5px 15px rgba(0, 0, 0, 0.2);
        overflow: hidden;
        // Use CSS variables for padding
        padding: var(--polaroid-padding, 4.7%);
        padding-bottom: 0;
    }

    &__polaroid-background {
        // Heavily blurred image that looks like a color gradient
        position: absolute;
        inset: -30%; // Extend well beyond bounds
        background-size: cover;
        background-position: center;
        filter: blur(var(--polaroid-bg-blur)) brightness(var(--polaroid-bg-brightness))
            saturate(var(--polaroid-bg-saturation));
        pointer-events: none;
        z-index: 0;
    }

    &__polaroid-texture {
        position: absolute;
        inset: -20%; // Extend beyond bounds to prevent edges showing
        background-size: cover;
        background-position: center;
        filter: blur(var(--texture-blur, 40px)) brightness(var(--texture-brightness, 1.5))
            saturate(var(--texture-saturation, 0.3));
        opacity: var(--texture-opacity, 0.12);
        pointer-events: none;
        z-index: 0;
    }

    &__polaroid-photo-container {
        position: relative;
        width: 100%;
        aspect-ratio: 4 / 5;
        flex-shrink: 0;
        overflow: hidden;
        z-index: 1;
    }

    &__polaroid-photo {
        width: 100%;
        height: 100%;
        background-size: cover;
        background-position: center;

        &--filtered {
            filter: sepia(0.1) saturate(1.1) brightness(1.02) contrast(0.95);
        }
    }

    &__polaroid-gloss {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(120deg, rgba(255, 255, 255, 0.6), transparent 60%, rgba(0, 0, 0, 0.5) 99%);
        box-shadow: inset 0 0 10px 1px rgba(0, 0, 0, 0.2);
        z-index: 10;
        pointer-events: none;
    }

    &__polaroid-grain {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)'/%3E%3C/svg%3E");
        opacity: 0.08;
        z-index: 11;
        pointer-events: none;
        mix-blend-mode: overlay;
    }

    &__polaroid-label {
        // Bottom padding area: 12% of screen = 14.1% of polaroid width
        height: var(--polaroid-bottom-padding, 14.1%);
        box-sizing: border-box;
        padding-top: var(--polaroid-padding, 4.7%);
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
        gap: var(--title-meta-gap, 4px);
        z-index: 1;
    }

    &__polaroid-title {
        // Font size from shared config - uses CSS variable
        font-family: var(--title-font-family, 'Caveat', cursive);
        font-size: var(--title-font-size, 24px);
        font-weight: var(--title-font-weight, 600);
        color: var(--title-color, #1a1a1a);
        line-height: 1.2;
    }

    &__polaroid-meta {
        // Meta font from shared config - uses CSS variable
        font-family: var(--meta-font-family, 'Inter', sans-serif);
        font-size: var(--meta-font-size, 12px);
        font-weight: var(--meta-font-weight, 400);
        color: var(--meta-color, #666666);
        line-height: 1.3;
    }

    &__status-bar {
        position: absolute;
        top: 16px;
        left: 0;
        right: 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 24px;
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
        font-size: 14px;
        font-weight: 600;
        color: $text-primary;
        z-index: 15;
    }

    &__carrier {
        font-weight: 600;
    }

    &__status-icons {
        display: flex;
        align-items: center;
        gap: 4px;
        font-size: 12px;
    }

    &__battery {
        font-size: 12px;
    }

    &__date {
        position: absolute;
        top: 60px;
        left: 50%;
        transform: translateX(-50%);
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
        font-size: 18px;
        font-weight: 500;
        color: $text-primary;
        z-index: 15;
    }

    &__clock {
        position: absolute;
        top: 50px;
        left: 50%;
        transform: translateX(-50%);
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', sans-serif;
        font-size: 95px;
        font-weight: 700;
        color: $text-primary;
        letter-spacing: -2px;
        z-index: 15;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
    }

    &__bottom-bar {
        position: absolute;
        bottom: 40px;
        left: 0;
        right: 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0 40px;
        z-index: 15;
    }

    &__bottom-button {
        width: 50px;
        height: 50px;
        background: rgba(255, 255, 255, 0.2);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        backdrop-filter: blur(10px);
    }

    &__focus-mode {
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', sans-serif;
        font-size: 14px;
        font-weight: 500;
        color: $text-primary;
        display: flex;
        align-items: center;
        gap: 6px;
    }

    &__home-indicator {
        position: absolute;
        bottom: 12px;
        left: 50%;
        transform: translateX(-50%);
        width: 135px;
        height: 5px;
        background: rgba(255, 255, 255, 0.5);
        border-radius: 3px;
        z-index: 15;
    }

    &__empty {
        display: flex;
        align-items: center;
        justify-content: center;
        height: 100%;
        color: $text-tertiary;
        font-size: 12px;
        text-align: center;
        padding: 20px;
    }
}
